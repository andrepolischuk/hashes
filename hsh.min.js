// Hsh Â© 2013-2015 Andrey Polischuk github.com/andrepolischuk/hsh
!function(){"use strict";function e(a,b){this.path=a,this.exp=this.pathRegExp(),this.params=this.pathParams(),this.fn=b}function f(a){var b=k.route.match(a.exp);if(b){this.route=k.route,this.params={};for(var c=0;c<a.params.length;c++)this.params[a.params[c]]=b[c+1]}}function g(){k.route=c.hash.substr(a.pref.length);for(var e,d=0;d<b.length;d++)if(e=new f(b[d]),"route"in e){b[d].fn.call(e);break}}function h(a){a!==c.hash&&(g(),a=c.hash),setTimeout(function(){h(a)},500)}function i(b,c){b in a&&(a[b]=c)}function j(){c.hash.length<=a.pref.length&&(c.hash=a.pref+a.index),g(),d?"addEventListener"in window?window.addEventListener("hashchange",g,!1):window.attachEvent("onhashchange",g):h()}function k(a,c){return"function"==typeof a?k("*",a):("function"==typeof c?b.push(new e(a,c)):j(),void 0)}var a={};a.pref="#",a.index="/";var b=[],c=window.location,d="onhashchange"in window&&!(/MSIE.\d+\./gi.test(navigator.userAgent)&&parseInt(navigator.userAgent.replace(/.*MSIE.(\d+)\..*/gi,"$1"))<8);e.prototype.pathRegExp=function(){if("*"===this.path)return new RegExp("^.*$");for(var a="^",b=this.path.split("/").splice(1,this.path.length),c=0;c<b.length;c++)a+="/"+b[c].replace(/([*])/g,".*").replace(/(:[A-Za-z0-9]+)/g,"(.+)");return a+="$",new RegExp(a)},e.prototype.pathParams=function(){for(var a=this.path.match(/:([A-Za-z0-9]+)/g)||[],b=0;b<a.length;b++)a[b]=a[b].substr(1);return a},k.route=null,k.set=function(a,b){if("object"==typeof a)for(var c in a)a.hasOwnProperty(c)&&i(c,a[c]);else i(a,b)},k.redirectInternal=function(b){b||(c.hash=a.pref+b)},k.redirectExternal=function(a){a||(c=a)},"function"==typeof define&&define.amd?define([],function(){return k}):"undefined"!=typeof module&&module.exports?module.exports=k:this.hsh=k}.call(this);
