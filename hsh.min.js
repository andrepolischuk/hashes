// Hsh Â© 2013-2015 Andrey Polischuk github.com/andrepolischuk/hsh
!function(){"use strict";function e(e){if("*"===e)return new RegExp("^.*$");var n="^";e=e.split("/").splice(1,e.length);for(var t=0;t<e.length;t++)n+="/"+e[t].replace(/(\(|\)|\[|\]|\\|\.|\^|\$|\||\?|\+)/g,"\\$1").replace(/([*])/g,".*").replace(/(:\w+)/g,"(.+)");return n+="$",new RegExp(n)}function n(e){for(var n=e.match(/:(\w+)/g)||[],t=0;t<n.length;t++)n[t]=n[t].substr(1);return n}function t(t,r){this.path=t,this.exp=e(this.path),this.params=n(this.path),this.fn=r}function r(e){var n=h.current.match(e.exp);if(n){this.route=h.current,this.params={};for(var t=0;t<e.params.length;t++)this.params[e.params[t]]=n[t+1]}}function i(){h.current=f.hash.substr(u.pref.length);for(var e,n=0;n<h.routes.length;n++)if(e=new r(h.routes[n]),"route"in e){h.routes[n].fn.call(e);break}}function a(e){e!==f.hash&&(i(),e=f.hash),setTimeout(function(){a(e)},500)}function o(e,n){e in u&&(u[e]=n)}function s(){f.hash.length<=u.pref.length&&(f.hash=u.pref+u.index),i(),c?"addEventListener"in window?window.addEventListener("hashchange",i,!1):window.attachEvent("onhashchange",i):a()}function h(e,n){return"function"==typeof e?h("*",e):void("function"==typeof n?h.routes.push(new t(e,n)):s())}var u={};u.pref="#",u.index="/";var f=window.location,c="onhashchange"in window&&!(/MSIE.\d+\./gi.test(navigator.userAgent)&&parseInt(navigator.userAgent.replace(/.*MSIE.(\d+)\..*/gi,"$1"))<8);h.current=null,h.routes=[],h.set=function(e,n){if("object"==typeof e)for(var t in e)e.hasOwnProperty(t)&&o(t,e[t]);else o(e,n)},h.redirectInternal=function(e){e||(f.hash=u.pref+e)},h.redirectExternal=function(e){e||(f=e)},"function"==typeof define&&define.amd?define([],function(){return h}):"undefined"!=typeof module&&module.exports?module.exports=h:this.hsh=h}.call(this);
