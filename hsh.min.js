// Hsh Â© 2013-2015 Andrey Polischuk github.com/andrepolischuk/hsh
!function(){"use strict";function e(e){if(e instanceof RegExp)return e;if("*"===e)return new RegExp("^.*$");var n="^";e=e.split("/").splice(1,e.length);for(var t=0;t<e.length;t++)n+="\\/"+e[t].replace(/(\(|\)|\[|\]|\\|\.|\^|\$|\||\?|\+)/g,"\\$1").replace(/([*])/g,".*").replace(/(:\w+)/g,"(.+)");return n+="$",new RegExp(n)}function n(e){if(e instanceof RegExp)return[];for(var n=e.match(/:(\w+)/g)||[],t=0;t<n.length;t++)n[t]=n[t].substr(1);return n}function t(t,i){this.path=t,this.exp=e(this.path),this.params=n(this.path),this.fn=i}function i(e,n){this.path=e,this.origin=n.path,this.exp=n.exp,this.params={};for(var t=e.match(n.exp),i=0;i<t.length-1;i++)this.params[n.params[i]||i]=t[i+1]}function r(){o.current=s.hash.replace(new RegExp(["^#",o.prefix.replace(/(\(|\)|\[|\]|\\|\.|\^|\$|\||\?|\+)/g,"\\$1"),"(.+)$"].join("")),"$1"),o.show(o.current)}function a(e){e!==s.hash&&(r(),e=s.hash),setTimeout(function(){a(e)},500)}function h(){s.hash.length<=o.prefix.length&&(s.hash=o.prefix+"/"),r(),u?"addEventListener"in window?window.addEventListener("hashchange",r,!1):window.attachEvent("onhashchange",r):a()}function o(e,n){return"function"==typeof e?o("*",e):void("function"==typeof n?o.routes.push(new t(e,n)):h())}var s=window.location,u="onhashchange"in window&&!(/MSIE.\d+\./gi.test(navigator.userAgent)&&parseInt(navigator.userAgent.replace(/.*MSIE.(\d+)\..*/gi,"$1"))<8);o.prefix="",o.current=null,o.routes=[],o.show=function(e){for(var n=0;n<o.routes.length;n++)if(e.match(o.routes[n].exp)){o.routes[n].fn.call(new i(e,o.routes[n]));break}},o.redirect=function(e){e&&(s.hash=o.prefix+e)},o.redirectExternal=function(e){e&&(s=e)},"function"==typeof define&&define.amd?define([],function(){return o}):"undefined"!=typeof module&&module.exports?module.exports=o:this.hsh=o}.call(this);
