// Hsh Â© 2013-2015 Andrey Polischuk github.com/andrepolischuk/hsh
!function(){"use strict";function n(n){if(n instanceof RegExp)return n;if("*"===n)return new RegExp("^.*$");var e="^";n=n.split("/").splice(1,n.length);for(var t=0;t<n.length;t++)e+="\\/"+n[t].replace(/(\(|\)|\[|\]|\\|\.|\^|\$|\||\?|\+)/g,"\\$1").replace(/([*])/g,".*").replace(/(:\w+)/g,"(.+)");return e+="$",new RegExp(e)}function e(n){if(n instanceof RegExp)return[];for(var e=n.match(/:(\w+)/g)||[],t=0;t<e.length;t++)e[t]=e[t].substr(1);return e}function t(t,r){this.path=t,this.exp=n(this.path),this.params=e(this.path),this.fn=r}function r(n,e){var t=n.match(e.exp);if(t){this.route=n,this.params={};for(var r=0;r<t.length-1;r++)this.params[e.params[r]||r]=t[r+1]}}function i(){h.current=u.hash.substr(f.pref.length),h.show(h.current)}function o(n){n!==u.hash&&(i(),n=u.hash),setTimeout(function(){o(n)},500)}function s(n,e){n in f&&(f[n]=e)}function a(){u.hash.length<=f.pref.length&&(u.hash=f.pref+f.index),i(),c?"addEventListener"in window?window.addEventListener("hashchange",i,!1):window.attachEvent("onhashchange",i):o()}function h(n,e){return"function"==typeof n?h("*",n):void("function"==typeof e?h.routes.push(new t(n,e)):"string"==typeof n?h.show(n):a())}var f={};f.pref="#",f.index="/";var u=window.location,c="onhashchange"in window&&!(/MSIE.\d+\./gi.test(navigator.userAgent)&&parseInt(navigator.userAgent.replace(/.*MSIE.(\d+)\..*/gi,"$1"))<8);h.current=null,h.routes=[],h.set=function(n,e){if("object"==typeof n)for(var t in n)n.hasOwnProperty(t)&&s(t,n[t]);else s(n,e)},h.show=function(n){for(var e,t=0;t<h.routes.length;t++)if(e=new r(n,h.routes[t]),"route"in e){h.routes[t].fn.call(e);break}},h.redirect=function(n){n&&(u.hash=f.pref+n)},h.redirectExternal=function(n){n&&(u=n)},"function"==typeof define&&define.amd?define([],function(){return h}):"undefined"!=typeof module&&module.exports?module.exports=h:this.hsh=h}.call(this);
